<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RenalCare AI | Kidney Health Analysis</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      :root {
        --teal-50: #f0fdfa;
        --teal-100: #ccfbf1;
        --teal-200: #99f6e4;
        --teal-300: #5eead4;
        --teal-400: #2dd4bf;
        --teal-500: #14b8a6;
        --teal-600: #0d9488;
        --teal-700: #0f766e;
        --teal-800: #115e59;
        --teal-900: #134e4a;

        --cyan-400: #22d3ee;
        --cyan-500: #06b6d4;

        --slate-50: #f8fafc;
        --slate-100: #f1f5f9;
        --slate-200: #e2e8f0;
        --slate-300: #cbd5e1;
        --slate-400: #94a3b8;
        --slate-500: #64748b;
        --slate-600: #475569;
        --slate-700: #334155;
        --slate-800: #1e293b;
        --slate-900: #0f172a;

        --red-400: #f87171;
        --red-500: #ef4444;
        --red-600: #dc2626;

        --green-400: #4ade80;
        --green-500: #22c55e;

        --amber-400: #fbbf24;
        --amber-500: #f59e0b;

        --gradient-teal: linear-gradient(135deg, #0d9488 0%, #115e59 100%);
        --gradient-hero: linear-gradient(
          135deg,
          #0f766e 0%,
          #134e4a 50%,
          #0f172a 100%
        );
        --glass-bg: rgba(255, 255, 255, 0.85);
        --glass-border: rgba(255, 255, 255, 0.2);

        --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        --shadow-md:
          0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        --shadow-lg:
          0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        --shadow-xl:
          0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        --shadow-glass: 0 8px 32px 0 rgba(31, 38, 135, 0.15);

        --radius: 12px;
        --radius-lg: 20px;
        --radius-xl: 28px;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          "Plus Jakarta Sans",
          -apple-system,
          BlinkMacSystemFont,
          sans-serif;
        background: var(--slate-100);
        min-height: 100vh;
        color: var(--slate-800);
        line-height: 1.6;
        -webkit-font-smoothing: antialiased;
      }

      /* ========== SIDEBAR ========== */
      .sidebar {
        position: fixed;
        left: 0;
        top: 0;
        bottom: 0;
        width: 280px;
        background: var(--gradient-hero);
        padding: 32px 24px;
        display: flex;
        flex-direction: column;
        z-index: 100;
        overflow-y: auto;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 48px;
      }

      .logo-icon {
        width: 52px;
        height: 52px;
        background: linear-gradient(
          135deg,
          var(--teal-400) 0%,
          var(--cyan-500) 100%
        );
        border-radius: var(--radius);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        box-shadow: 0 4px 12px rgba(20, 184, 166, 0.4);
        padding: 10px;
      }

      .logo-icon svg {
        width: 100%;
        height: 100%;
      }

      .logo-text {
        color: white;
      }

      .logo-text h1 {
        font-size: 1.25rem;
        font-weight: 700;
        letter-spacing: -0.5px;
      }

      .logo-text span {
        font-size: 0.75rem;
        color: var(--teal-300);
        font-weight: 500;
      }

      .nav-section {
        margin-bottom: 32px;
      }

      .nav-label {
        font-size: 0.6875rem;
        font-weight: 600;
        color: var(--teal-400);
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 16px;
        padding-left: 12px;
      }

      .nav-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 14px;
        border-radius: var(--radius);
        color: var(--slate-300);
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.25s ease;
        margin-bottom: 6px;
        border: 1px solid transparent;
      }

      .nav-item:hover {
        background: rgba(255, 255, 255, 0.08);
        color: white;
      }

      .nav-item.active {
        background: rgba(20, 184, 166, 0.15);
        color: var(--teal-300);
        border-color: var(--teal-600);
      }

      .nav-item i {
        width: 18px;
        text-align: center;
        font-size: 0.875rem;
        flex-shrink: 0;
      }

      .nav-item span:not(.nav-step-badge) {
        flex: 1;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .nav-step-badge {
        margin-left: auto;
        font-size: 0.625rem;
        padding: 3px 8px;
        background: var(--teal-700);
        border-radius: 12px;
        color: var(--teal-200);
        flex-shrink: 0;
        white-space: nowrap;
      }

      .nav-item.completed .nav-step-badge {
        background: var(--green-500);
        color: white;
      }

      .sidebar-footer {
        margin-top: auto;
        padding-top: 24px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
      }

      .model-info {
        padding: 16px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: var(--radius);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .model-info-title {
        font-size: 0.75rem;
        color: var(--slate-400);
        margin-bottom: 12px;
      }

      .model-badge {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.8125rem;
        color: var(--teal-300);
        margin-bottom: 8px;
      }

      .model-badge i {
        color: var(--green-400);
      }

      /* ========== MAIN CONTENT ========== */
      .main-content {
        margin-left: 280px;
        min-height: 100vh;
        padding: 32px 40px;
        background: linear-gradient(
          180deg,
          var(--teal-50) 0%,
          var(--slate-100) 100%
        );
      }

      .page-header {
        margin-bottom: 32px;
      }

      .greeting {
        font-size: 0.875rem;
        color: var(--slate-500);
        margin-bottom: 4px;
      }

      .page-title {
        font-size: 2rem;
        font-weight: 700;
        color: var(--slate-900);
        letter-spacing: -0.5px;
      }

      .page-title span {
        color: var(--teal-600);
      }

      /* ========== STEP CONTENT ========== */
      .step-content {
        display: none;
        animation: fadeSlideUp 0.5s ease;
      }

      .step-content.active {
        display: block;
      }

      @keyframes fadeSlideUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* ========== CARD STYLES ========== */
      .card {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-radius: var(--radius-lg);
        border: 1px solid var(--glass-border);
        box-shadow: var(--shadow-glass);
        overflow: hidden;
        transition: all 0.3s ease;
      }

      .card:hover {
        box-shadow: var(--shadow-xl);
        transform: translateY(-2px);
      }

      .card-header {
        padding: 24px 28px;
        border-bottom: 1px solid var(--slate-200);
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .card-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--slate-800);
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .card-title i {
        width: 36px;
        height: 36px;
        background: var(--teal-100);
        color: var(--teal-600);
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1rem;
      }

      .card-badge {
        font-size: 0.6875rem;
        font-weight: 600;
        padding: 6px 12px;
        border-radius: 20px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .card-badge.required {
        background: var(--red-500);
        color: white;
      }

      .card-badge.vgg16 {
        background: linear-gradient(
          135deg,
          var(--teal-500) 0%,
          var(--cyan-500) 100%
        );
        color: white;
      }

      .card-badge.xgboost {
        background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%);
        color: white;
      }

      .card-body {
        padding: 28px;
      }

      /* ========== DASHBOARD GRID ========== */
      .dashboard-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 24px;
        margin-bottom: 24px;
        align-items: start;
      }

      .dashboard-grid .card {
        display: flex;
        flex-direction: column;
      }

      .dashboard-grid .card .card-body {
        flex: 1;
        display: flex;
        flex-direction: column;
      }

      /* ========== UPLOAD AREA ========== */
      .upload-area {
        border: 2px dashed var(--teal-300);
        border-radius: var(--radius-lg);
        padding: 48px 32px;
        text-align: center;
        background: linear-gradient(135deg, var(--teal-50) 0%, white 100%);
        transition: all 0.3s ease;
        cursor: pointer;
        min-height: 320px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
      }

      .upload-area::before {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(
          135deg,
          transparent 0%,
          rgba(20, 184, 166, 0.05) 100%
        );
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .upload-area:hover {
        border-color: var(--teal-500);
        background: linear-gradient(135deg, var(--teal-100) 0%, white 100%);
      }

      .upload-area:hover::before {
        opacity: 1;
      }

      .upload-area.dragover {
        border-color: var(--teal-500);
        background: var(--teal-100);
        transform: scale(1.01);
      }

      .upload-area.has-image {
        padding: 16px;
        border-style: solid;
        border-color: var(--teal-500);
      }

      .upload-icon {
        width: 80px;
        height: 80px;
        background: linear-gradient(
          135deg,
          var(--teal-500) 0%,
          var(--teal-600) 100%
        );
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 24px;
        box-shadow: 0 8px 24px rgba(20, 184, 166, 0.35);
      }

      .upload-icon i {
        font-size: 2rem;
        color: white;
      }

      .upload-title {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--slate-800);
        margin-bottom: 8px;
      }

      .upload-subtitle {
        font-size: 0.875rem;
        color: var(--slate-500);
        margin-bottom: 20px;
      }

      .upload-formats {
        display: flex;
        gap: 8px;
        justify-content: center;
      }

      .format-tag {
        font-size: 0.6875rem;
        font-weight: 600;
        padding: 6px 12px;
        background: white;
        border: 1px solid var(--slate-200);
        border-radius: 6px;
        color: var(--slate-600);
      }

      .preview-image {
        width: 100%;
        max-height: 280px;
        object-fit: contain;
        border-radius: var(--radius);
        display: none;
      }

      .preview-image.show {
        display: block;
      }

      .placeholder-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
        z-index: 1;
      }

      input[type="file"] {
        display: none;
      }

      /* ========== VITAL STATS CARDS ========== */
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 16px;
        margin-bottom: 20px;
      }

      .stat-card {
        background: linear-gradient(
          135deg,
          var(--teal-500) 0%,
          var(--teal-600) 100%
        );
        border-radius: var(--radius);
        padding: 20px;
        color: white;
        position: relative;
        overflow: hidden;
      }

      .stat-card::after {
        content: "";
        position: absolute;
        top: -50%;
        right: -50%;
        width: 100%;
        height: 100%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.1) 0%,
          transparent 70%
        );
      }

      .stat-card.cyan {
        background: linear-gradient(135deg, var(--cyan-500) 0%, #0891b2 100%);
      }

      .stat-label {
        font-size: 0.75rem;
        opacity: 0.9;
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .stat-label i {
        font-size: 0.625rem;
      }

      .stat-value {
        font-size: 1.75rem;
        font-weight: 700;
      }

      .stat-unit {
        font-size: 0.875rem;
        font-weight: 400;
        opacity: 0.8;
      }

      /* ========== FORM ELEMENTS ========== */
      .form-grid {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
      }

      .form-group {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .form-label {
        font-size: 0.8125rem;
        font-weight: 600;
        color: var(--slate-700);
      }

      /* Toggle Switch */
      .toggle-group {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .toggle {
        position: relative;
        width: 52px;
        height: 28px;
      }

      .toggle input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      .toggle-track {
        position: absolute;
        cursor: pointer;
        inset: 0;
        background: var(--slate-300);
        border-radius: 28px;
        transition: 0.3s ease;
      }

      .toggle-track::before {
        content: "";
        position: absolute;
        height: 22px;
        width: 22px;
        left: 3px;
        bottom: 3px;
        background: white;
        border-radius: 50%;
        transition: 0.3s ease;
        box-shadow: var(--shadow-md);
      }

      .toggle input:checked + .toggle-track {
        background: linear-gradient(
          135deg,
          var(--teal-500) 0%,
          var(--teal-600) 100%
        );
      }

      .toggle input:checked + .toggle-track::before {
        transform: translateX(24px);
      }

      .toggle-label {
        font-size: 0.875rem;
        color: var(--slate-600);
        font-weight: 500;
      }

      /* Range Slider */
      .range-slider {
        position: relative;
        padding-top: 8px;
      }

      .slider-input {
        -webkit-appearance: none;
        width: 100%;
        height: 8px;
        border-radius: 4px;
        background: var(--slate-200);
        outline: none;
        cursor: pointer;
      }

      .slider-input::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        background: linear-gradient(
          135deg,
          var(--teal-500) 0%,
          var(--teal-600) 100%
        );
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(20, 184, 166, 0.4);
        transition: transform 0.2s ease;
      }

      .slider-input::-webkit-slider-thumb:hover {
        transform: scale(1.15);
      }

      .slider-labels {
        display: flex;
        justify-content: space-between;
        margin-top: 8px;
        font-size: 0.75rem;
        color: var(--slate-500);
      }

      /* Input */
      .input-field {
        width: 100%;
        padding: 14px 16px;
        border: 1px solid var(--slate-300);
        border-radius: var(--radius);
        font-size: 0.9375rem;
        font-weight: 500;
        color: var(--slate-800);
        background: white;
        transition: all 0.2s ease;
      }

      .input-field:focus {
        outline: none;
        border-color: var(--teal-500);
        box-shadow: 0 0 0 4px rgba(20, 184, 166, 0.15);
      }

      .input-wrapper {
        position: relative;
      }

      .input-suffix {
        position: absolute;
        right: 16px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 0.875rem;
        color: var(--slate-500);
      }

      /* Select */
      .select-field {
        width: 100%;
        padding: 14px 16px;
        padding-right: 44px;
        border: 1px solid var(--slate-300);
        border-radius: var(--radius);
        font-size: 0.9375rem;
        font-weight: 500;
        color: var(--slate-800);
        background: white;
        cursor: pointer;
        appearance: none;
        transition: all 0.2s ease;
      }

      .select-field:focus {
        outline: none;
        border-color: var(--teal-500);
        box-shadow: 0 0 0 4px rgba(20, 184, 166, 0.15);
      }

      .select-wrapper {
        position: relative;
      }

      .select-arrow {
        position: absolute;
        right: 16px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--slate-400);
        pointer-events: none;
      }

      /* ========== BUTTONS ========== */
      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        padding: 16px 32px;
        font-size: 0.9375rem;
        font-weight: 600;
        border: none;
        border-radius: var(--radius);
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .btn::before {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.15) 0%,
          transparent 100%
        );
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .btn:hover::before {
        opacity: 1;
      }

      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none !important;
      }

      .btn-primary {
        background: linear-gradient(
          135deg,
          var(--teal-500) 0%,
          var(--teal-600) 100%
        );
        color: white;
        box-shadow: 0 4px 14px rgba(20, 184, 166, 0.4);
      }

      .btn-primary:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(20, 184, 166, 0.5);
      }

      .btn-secondary {
        background: white;
        color: var(--slate-700);
        border: 1px solid var(--slate-300);
      }

      .btn-secondary:hover:not(:disabled) {
        background: var(--slate-100);
        border-color: var(--slate-400);
      }

      .btn-success {
        background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
        color: white;
        box-shadow: 0 4px 14px rgba(34, 197, 94, 0.4);
      }

      .btn-success:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(34, 197, 94, 0.5);
      }

      .btn-lg {
        padding: 18px 36px;
        font-size: 1rem;
      }

      .btn-full {
        width: 100%;
      }

      .btn-group {
        display: flex;
        gap: 16px;
        margin-top: 28px;
      }

      /* Button Loading */
      .btn.loading {
        color: transparent;
        pointer-events: none;
      }

      .btn.loading::after {
        content: "";
        position: absolute;
        width: 24px;
        height: 24px;
        border: 3px solid rgba(255, 255, 255, 0.3);
        border-top-color: white;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* ========== RESULT SECTION ========== */
      .result-placeholder {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 0px 30px 30px 30px;
        text-align: center;
        min-height: 280px;
      }

      .result-icon {
        width: 72px;
        height: 72px;
        background: var(--slate-100);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 20px;
      }

      .result-icon i {
        font-size: 1.75rem;
        color: var(--slate-400);
      }

      .result-text {
        font-size: 1rem;
        color: var(--slate-500);
        max-width: 300px;
      }

      /* ========== DIAGNOSIS DISPLAY ========== */
      .diagnosis-result {
        animation: scaleIn 0.5s ease;
      }

      @keyframes scaleIn {
        from {
          opacity: 0;
          transform: scale(0.95);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      .diagnosis-header {
        padding: 32px;
        text-align: center;
        border-radius: var(--radius-lg) var(--radius-lg) 0 0;
        position: relative;
        overflow: hidden;
      }

      .diagnosis-header::before {
        content: "";
        position: absolute;
        inset: 0;
        background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      }

      .diagnosis-header.tumor {
        background: linear-gradient(
          135deg,
          var(--red-500) 0%,
          var(--red-600) 100%
        );
      }

      .diagnosis-header.normal {
        background: linear-gradient(
          135deg,
          var(--teal-500) 0%,
          var(--teal-600) 100%
        );
      }

      .diagnosis-icon-wrapper {
        width: 80px;
        height: 80px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 20px;
        backdrop-filter: blur(10px);
      }

      .diagnosis-icon-wrapper i {
        font-size: 2.25rem;
        color: white;
      }

      .diagnosis-badge {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        padding: 12px 28px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50px;
        color: white;
        font-size: 1.25rem;
        font-weight: 700;
        letter-spacing: 1px;
        backdrop-filter: blur(10px);
      }

      .diagnosis-subtitle {
        color: rgba(255, 255, 255, 0.9);
        font-size: 0.9375rem;
        margin-top: 16px;
      }

      .diagnosis-body {
        padding: 28px;
        background: white;
        border-radius: 0 0 var(--radius-lg) var(--radius-lg);
      }

      .confidence-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
        margin-bottom: 20px;
      }

      .confidence-card {
        background: var(--slate-100);
        border-radius: var(--radius);
        padding: 20px;
        text-align: center;
      }

      .confidence-label {
        font-size: 0.75rem;
        font-weight: 600;
        color: var(--slate-500);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 8px;
      }

      .confidence-value {
        font-size: 2rem;
        font-weight: 700;
      }

      .confidence-value.tumor {
        color: var(--red-500);
      }
      .confidence-value.normal {
        color: var(--teal-600);
      }

      /* ========== RISK GAUGE ========== */
      .gauge-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 32px;
        background: white;
        border-radius: var(--radius-lg);
        position: relative;
        overflow: hidden;
      }

      .gauge-container::before {
        content: "";
        position: absolute;
        top: -100px;
        right: -100px;
        width: 200px;
        height: 200px;
        background: radial-gradient(
          circle,
          rgba(20, 184, 166, 0.08) 0%,
          transparent 70%
        );
        pointer-events: none;
      }

      .gauge-container::after {
        content: "";
        position: absolute;
        bottom: -80px;
        left: -80px;
        width: 160px;
        height: 160px;
        background: radial-gradient(
          circle,
          rgba(245, 158, 11, 0.06) 0%,
          transparent 70%
        );
        pointer-events: none;
      }

      .gauge-title {
        font-size: 0.9375rem;
        font-weight: 600;
        color: var(--slate-700);
        margin-bottom: 28px;
        display: flex;
        align-items: center;
        gap: 10px;
        position: relative;
        z-index: 1;
      }

      .gauge-title i {
        color: var(--teal-500);
      }

      .gauge-wrapper {
        position: relative;
        z-index: 1;
      }

      .gauge {
        position: relative;
        width: 200px;
        height: 200px;
        cursor: pointer;
        transition: transform 0.3s ease;
      }

      .gauge:hover {
        transform: scale(1.05);
      }

      .gauge svg {
        transform: rotate(-90deg);
        filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.1));
      }

      .gauge-bg {
        fill: none;
        stroke: var(--slate-200);
        stroke-width: 14;
      }

      .gauge-fill {
        fill: none;
        stroke-width: 14;
        stroke-linecap: round;
        transition:
          stroke-dashoffset 1.5s cubic-bezier(0.4, 0, 0.2, 1),
          stroke 0.5s ease;
        filter: drop-shadow(0 2px 8px currentColor);
      }

      .gauge-fill.low {
        stroke: var(--green-500);
        filter: drop-shadow(0 2px 8px rgba(34, 197, 94, 0.4));
      }
      .gauge-fill.medium {
        stroke: var(--amber-500);
        filter: drop-shadow(0 2px 8px rgba(245, 158, 11, 0.4));
      }
      .gauge-fill.high {
        stroke: var(--red-500);
        filter: drop-shadow(0 2px 8px rgba(239, 68, 68, 0.4));
      }

      .gauge-glow {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 140px;
        height: 140px;
        border-radius: 50%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.9) 0%,
          rgba(255, 255, 255, 0.3) 70%,
          transparent 100%
        );
        pointer-events: none;
      }

      .gauge-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
        z-index: 2;
      }

      .gauge-value {
        font-size: 2.75rem;
        font-weight: 800;
        color: var(--slate-800);
        line-height: 1;
        transition: transform 0.3s ease;
      }

      .gauge:hover .gauge-value {
        transform: scale(1.1);
      }

      .gauge-label {
        font-size: 0.75rem;
        font-weight: 600;
        color: var(--slate-500);
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-top: 6px;
      }

      .gauge-legend {
        display: flex;
        gap: 20px;
        margin-top: 24px;
        position: relative;
        z-index: 1;
      }

      .gauge-legend-item {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 0.75rem;
        color: var(--slate-600);
      }

      .gauge-legend-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
      }

      .gauge-legend-dot.low {
        background: var(--green-500);
      }
      .gauge-legend-dot.medium {
        background: var(--amber-500);
      }
      .gauge-legend-dot.high {
        background: var(--red-500);
      }

      /* ========== STEP 2 FORM ========== */
      .form-container {
        background: white;
        border-radius: var(--radius-lg);
        border: 1px solid var(--slate-200);
        overflow: hidden;
      }

      .form-header {
        padding: 28px 32px;
        background: var(--gradient-teal);
        color: white;
      }

      .form-header h2 {
        font-size: 1.375rem;
        font-weight: 700;
        margin-bottom: 8px;
      }

      .form-header p {
        opacity: 0.9;
        font-size: 0.9375rem;
      }

      .form-body {
        padding: 32px;
      }

      .form-section {
        margin-bottom: 32px;
      }

      .form-section-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--slate-800);
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 12px;
        padding-bottom: 12px;
        border-bottom: 1px solid var(--slate-200);
      }

      .form-section-title i {
        width: 32px;
        height: 32px;
        background: var(--teal-100);
        color: var(--teal-600);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.875rem;
      }

      .form-section-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
      }

      /* Radio Pills */
      .radio-pills {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      .radio-pill {
        position: relative;
      }

      .radio-pill input {
        position: absolute;
        opacity: 0;
        width: 0;
        height: 0;
      }

      .radio-pill label {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 12px 20px;
        background: white;
        border: 1px solid var(--slate-300);
        border-radius: var(--radius);
        font-size: 0.875rem;
        font-weight: 500;
        color: var(--slate-600);
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .radio-pill input:checked + label {
        background: var(--teal-500);
        border-color: var(--teal-500);
        color: white;
        box-shadow: 0 4px 12px rgba(20, 184, 166, 0.3);
      }

      .radio-pill label:hover {
        border-color: var(--teal-400);
      }

      /* ========== STEP 3 RESULTS ========== */
      .results-container {
        background: white;
        border-radius: var(--radius-lg);
        border: 1px solid var(--slate-200);
        overflow: hidden;
      }

      .results-header {
        padding: 28px 32px;
        background: var(--gradient-teal);
        color: white;
        text-align: center;
      }

      .results-header h2 {
        font-size: 1.375rem;
        font-weight: 700;
      }

      .results-body {
        padding: 32px;
      }

      .results-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 24px;
        margin-top: 24px;
        align-items: start;
      }

      .results-top-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 24px;
        align-items: start;
      }

      .results-top-grid .diagnosis-result {
        display: flex;
        flex-direction: column;
        background: white;
        border-radius: var(--radius-lg);
        overflow: hidden;
        box-shadow: var(--shadow-glass);
      }

      .results-top-grid .diagnosis-body {
        padding: 20px;
        text-align: center;
      }

      .results-top-grid .gauge-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        box-shadow: var(--shadow-glass);
      }

      .result-card {
        background: var(--slate-50);
        border-radius: var(--radius);
        padding: 24px;
        border: 1px solid var(--slate-200);
      }

      .result-card-title {
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--slate-600);
        margin-bottom: 16px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .result-card-title i {
        color: var(--teal-500);
      }

      .risk-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid var(--slate-200);
      }

      .risk-item:last-child {
        border-bottom: none;
      }

      .risk-label {
        font-size: 0.875rem;
        color: var(--slate-700);
        font-weight: 500;
      }

      .risk-badge {
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
      }

      .risk-badge.high {
        background: rgba(239, 68, 68, 0.1);
        color: var(--red-600);
      }

      .risk-badge.medium {
        background: rgba(245, 158, 11, 0.1);
        color: var(--amber-500);
      }

      .risk-badge.low {
        background: rgba(34, 197, 94, 0.1);
        color: var(--green-500);
      }

      /* ========== LOADING OVERLAY ========== */
      #loading {
        position: fixed;
        inset: 0;
        background: rgba(15, 23, 42, 0.9);
        backdrop-filter: blur(12px);
        display: none;
        z-index: 9999;
        align-items: center;
        justify-content: center;
        flex-direction: column;
      }

      #loading.show {
        display: flex;
      }

      .loader-wrapper {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 28px;
      }

      .loader-ring {
        width: 72px;
        height: 72px;
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-top-color: var(--teal-400);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      .loader-text {
        color: white;
        font-size: 1.125rem;
        font-weight: 600;
      }

      .loader-subtext {
        color: var(--slate-400);
        font-size: 0.875rem;
        margin-top: 4px;
      }

      /* ========== INFO BOX ========== */
      .info-box {
        display: flex;
        align-items: flex-start;
        gap: 14px;
        padding: 18px 20px;
        background: var(--teal-50);
        border-radius: var(--radius);
        border-left: 4px solid var(--teal-500);
        margin-top: 24px;
      }

      .info-box i {
        color: var(--teal-600);
        margin-top: 2px;
      }

      .info-box-text {
        font-size: 0.875rem;
        color: var(--teal-800);
        line-height: 1.6;
      }

      /* ========== RESPONSIVE ========== */
      @media (max-width: 1200px) {
        .sidebar {
          width: 240px;
        }
        .main-content {
          margin-left: 240px;
        }
      }

      @media (max-width: 992px) {
        .sidebar {
          transform: translateX(-100%);
          width: 280px;
        }
        .main-content {
          margin-left: 0;
        }
        .dashboard-grid {
          grid-template-columns: 1fr;
        }
        .results-grid {
          grid-template-columns: 1fr;
        }
        .form-section-grid {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .main-content {
          padding: 20px;
        }
        .card-body {
          padding: 20px;
        }
        .form-row {
          grid-template-columns: 1fr;
        }
        .btn-group {
          flex-direction: column;
        }
        .confidence-row {
          grid-template-columns: 1fr;
        }
      }

      /* ========== HIDDEN ========== */
      #stepLabel {
        display: none;
      }
    </style>
  </head>
  <body>
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="logo">
        <div class="logo-icon">
          <svg
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M12 2C8.5 2 6 4.5 6 8c0 2 .8 3.8 2 5l-1.5 6c-.2.8.4 1.5 1.2 1.5h8.6c.8 0 1.4-.7 1.2-1.5L16 13c1.2-1.2 2-3 2-5 0-3.5-2.5-6-6-6z"
              fill="white"
              stroke="white"
              stroke-width="0.5"
            />
            <path
              d="M9 8c0-1.7 1.3-3 3-3"
              stroke="rgba(255,255,255,0.5)"
              stroke-width="1.5"
              stroke-linecap="round"
            />
            <circle cx="10" cy="10" r="1" fill="rgba(255,255,255,0.4)" />
            <circle cx="14" cy="9" r="0.8" fill="rgba(255,255,255,0.3)" />
          </svg>
        </div>
        <div class="logo-text">
          <h1>RenalCare</h1>
          <span>AI Diagnostics</span>
        </div>
      </div>

      <nav class="nav-section">
        <div class="nav-label">Analysis Steps</div>
        <div class="nav-item active" id="nav-step1" onclick="goToStep(1)">
          <i class="fas fa-upload"></i>
          <span>CT Scan Upload</span>
          <span class="nav-step-badge">Step 1</span>
        </div>
        <div class="nav-item" id="nav-step2" onclick="goToStep(2)">
          <i class="fas fa-clipboard-list"></i>
          <span>Health Profile</span>
          <span class="nav-step-badge">Step 2</span>
        </div>
        <div class="nav-item" id="nav-step3" onclick="goToStep(3)">
          <i class="fas fa-chart-pie"></i>
          <span>Risk Assessment</span>
          <span class="nav-step-badge">Step 3</span>
        </div>
      </nav>

      <div class="sidebar-footer">
        <div class="model-info">
          <div class="model-info-title">Active Models</div>
          <div class="model-badge">
            <i class="fas fa-circle"></i>
            VGG16 Neural Network
          </div>
          <div class="model-badge">
            <i class="fas fa-circle"></i>
            XGBoost Classifier
          </div>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <div class="page-header">
        <p class="greeting">Welcome to your dashboard</p>
        <h1 class="page-title">Kidney <span>Health Analysis</span></h1>
      </div>

      <!-- Hidden step label for compatibility -->
      <span id="stepLabel">Step 1/3: Upload CT Scan Image</span>

      <!-- STEP 1: Upload & Analysis -->
      <div id="step1" class="step-content active">
        <div class="dashboard-grid">
          <!-- Upload Card -->
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">
                <i class="fas fa-x-ray"></i>
                CT Scan Input
              </h3>
              <span class="card-badge vgg16">VGG16</span>
            </div>
            <div class="card-body">
              <label for="fileinput" class="upload-area" id="uploadArea">
                <div class="placeholder-content" id="placeholderContent">
                  <div class="upload-icon">
                    <i class="fas fa-cloud-upload-alt"></i>
                  </div>
                  <p class="upload-title">Upload CT Scan Image</p>
                  <p class="upload-subtitle">Drag & drop or click to browse</p>
                  <div class="upload-formats">
                    <span class="format-tag">DICOM</span>
                    <span class="format-tag">PNG</span>
                    <span class="format-tag">JPG</span>
                  </div>
                </div>
                <img id="photo" class="preview-image" />
              </label>
              <input type="file" id="fileinput" accept="image/*" />

              <div class="info-box">
                <i class="fas fa-shield-alt"></i>
                <span class="info-box-text"
                  >Your data is processed securely and never stored. All
                  analysis happens in real-time with HIPAA-compliant
                  protocols.</span
                >
              </div>
            </div>
          </div>

          <!-- Results Card -->
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">
                <i class="fas fa-stethoscope"></i>
                Diagnosis Result
              </h3>
              <span class="card-badge required">AI Analysis</span>
            </div>
            <div class="card-body">
              <div id="imageResultContainer" class="result-placeholder">
                <div class="result-icon">
                  <i class="fas fa-microscope"></i>
                </div>
                <p class="result-text">
                  Upload a CT scan image and click "Analyze" to get AI-powered
                  diagnosis
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="btn-group" style="justify-content: center">
          <button
            type="button"
            class="btn btn-primary btn-lg"
            id="predictImageBtn"
            disabled
          >
            <i class="fas fa-brain"></i>
            <span id="analyzeBtnText">Analyze Scan</span>
          </button>
          <button
            type="button"
            class="btn btn-success btn-lg"
            id="proceedToQuestionnaire"
            disabled
            style="display: none"
          >
            <i class="fas fa-arrow-right"></i>
            Continue to Health Profile
          </button>
        </div>
      </div>

      <!-- STEP 2: Health Questionnaire -->
      <div id="step2" class="step-content">
        <div class="form-container">
          <div class="form-header">
            <h2>Complete Health Profile</h2>
            <p>
              Provide clinical information for comprehensive XGBoost risk
              analysis
            </p>
          </div>
          <div class="form-body">
            <!-- Symptoms Section -->
            <div class="form-section">
              <h4 class="form-section-title">
                <i class="fas fa-heartbeat"></i>
                Current Symptoms
              </h4>
              <div class="form-section-grid">
                <div class="form-group">
                  <label class="form-label">Blood in Urine (Hematuria)?</label>
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="hematuria_no"
                        name="hematuria"
                        value="0"
                        checked
                      />
                      <label for="hematuria_no">No</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="hematuria_yes"
                        name="hematuria"
                        value="1"
                      />
                      <label for="hematuria_yes">Yes</label>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">Flank Pain Severity?</label>
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="flank_pain_none"
                        name="flank_pain"
                        value="0"
                        checked
                      />
                      <label for="flank_pain_none">None</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="flank_pain_mild"
                        name="flank_pain"
                        value="1"
                      />
                      <label for="flank_pain_mild">Mild</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="flank_pain_severe"
                        name="flank_pain"
                        value="2"
                      />
                      <label for="flank_pain_severe">Severe</label>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">Lower Back Pain?</label>
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="lower_back_pain_no"
                        name="lower_back_pain"
                        value="0"
                        checked
                      />
                      <label for="lower_back_pain_no">No</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="lower_back_pain_yes"
                        name="lower_back_pain"
                        value="1"
                      />
                      <label for="lower_back_pain_yes">Yes</label>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">Fever?</label>
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="fever_no"
                        name="fever"
                        value="0"
                        checked
                      />
                      <label for="fever_no">No</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="fever_yes"
                        name="fever"
                        value="1"
                      />
                      <label for="fever_yes">Yes</label>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">Loss of Appetite?</label>
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="appetite_loss_no"
                        name="appetite_loss"
                        value="0"
                        checked
                      />
                      <label for="appetite_loss_no">No</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="appetite_loss_yes"
                        name="appetite_loss"
                        value="1"
                      />
                      <label for="appetite_loss_yes">Yes</label>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">Unexplained Weight Loss?</label>
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="weight_loss_no"
                        name="weight_loss"
                        value="0"
                        checked
                      />
                      <label for="weight_loss_no">No</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="weight_loss_yes"
                        name="weight_loss"
                        value="1"
                      />
                      <label for="weight_loss_yes">Yes</label>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">Fatigue?</label>
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="fatigue_no"
                        name="fatigue"
                        value="0"
                        checked
                      />
                      <label for="fatigue_no">No</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="fatigue_yes"
                        name="fatigue"
                        value="1"
                      />
                      <label for="fatigue_yes">Yes</label>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">Anemia Diagnosis?</label>
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="anemia_no"
                        name="anemia"
                        value="0"
                        checked
                      />
                      <label for="anemia_no">No</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="anemia_yes"
                        name="anemia"
                        value="1"
                      />
                      <label for="anemia_yes">Yes</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Medical History -->
            <div class="form-section">
              <h4 class="form-section-title">
                <i class="fas fa-file-medical"></i>
                Medical History
              </h4>
              <div class="form-section-grid">
                <div class="form-group">
                  <label class="form-label">Hypertension (High BP)?</label>
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="hypertension_no"
                        name="hypertension"
                        value="0"
                        checked
                      />
                      <label for="hypertension_no">No</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="hypertension_yes"
                        name="hypertension"
                        value="1"
                      />
                      <label for="hypertension_yes">Yes</label>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">Diabetes?</label>
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="diabetes_no"
                        name="diabetes"
                        value="0"
                        checked
                      />
                      <label for="diabetes_no">No</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="diabetes_yes"
                        name="diabetes"
                        value="1"
                      />
                      <label for="diabetes_yes">Yes</label>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">Chronic Kidney Disease?</label>
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="ckd_no"
                        name="ckd"
                        value="0"
                        checked
                      />
                      <label for="ckd_no">No</label>
                    </div>
                    <div class="radio-pill">
                      <input type="radio" id="ckd_yes" name="ckd" value="1" />
                      <label for="ckd_yes">Yes</label>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label"
                    >Family History: Kidney Tumors?</label
                  >
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="fh_kidney_tumor_no"
                        name="fh_kidney_tumor"
                        value="0"
                        checked
                      />
                      <label for="fh_kidney_tumor_no">No</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="fh_kidney_tumor_yes"
                        name="fh_kidney_tumor"
                        value="1"
                      />
                      <label for="fh_kidney_tumor_yes">Yes</label>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label"
                    >Family History: Hypertension?</label
                  >
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="fh_hypertension_no"
                        name="fh_hypertension"
                        value="0"
                        checked
                      />
                      <label for="fh_hypertension_no">No</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="fh_hypertension_yes"
                        name="fh_hypertension"
                        value="1"
                      />
                      <label for="fh_hypertension_yes">Yes</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Lifestyle -->
            <div class="form-section">
              <h4 class="form-section-title">
                <i class="fas fa-running"></i>
                Lifestyle Factors
              </h4>
              <div class="form-section-grid">
                <div class="form-group">
                  <label class="form-label">Smoking Status?</label>
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="smoking_never"
                        name="smoking"
                        value="0"
                        checked
                      />
                      <label for="smoking_never">Never</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="smoking_former"
                        name="smoking"
                        value="1"
                      />
                      <label for="smoking_former">Former</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="smoking_current"
                        name="smoking"
                        value="2"
                      />
                      <label for="smoking_current">Current</label>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">Alcohol Intake (per week)?</label>
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="alcohol_none"
                        name="alcohol"
                        value="0"
                        checked
                      />
                      <label for="alcohol_none">None</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="alcohol_low"
                        name="alcohol"
                        value="1"
                      />
                      <label for="alcohol_low">&lt;7</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="alcohol_high"
                        name="alcohol"
                        value="2"
                      />
                      <label for="alcohol_high">&gt;7</label>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">Height (cm)</label>
                  <div class="input-wrapper">
                    <input
                      type="number"
                      class="input-field"
                      id="height"
                      placeholder="170"
                      min="100"
                      max="250"
                    />
                    <span class="input-suffix">cm</span>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">Weight (kg)</label>
                  <div class="input-wrapper">
                    <input
                      type="number"
                      class="input-field"
                      id="weight"
                      placeholder="70"
                      min="20"
                      max="300"
                    />
                    <span class="input-suffix">kg</span>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label"
                    >Occupational Chemical Exposure?</label
                  >
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="chemical_exposure_no"
                        name="chemical_exposure"
                        value="0"
                        checked
                      />
                      <label for="chemical_exposure_no">No</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="chemical_exposure_yes"
                        name="chemical_exposure"
                        value="1"
                      />
                      <label for="chemical_exposure_yes">Yes</label>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">Physical Activity Level?</label>
                  <div class="radio-pills">
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="activity_low"
                        name="activity"
                        value="0"
                        checked
                      />
                      <label for="activity_low">Low</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="activity_moderate"
                        name="activity"
                        value="1"
                      />
                      <label for="activity_moderate">Moderate</label>
                    </div>
                    <div class="radio-pill">
                      <input
                        type="radio"
                        id="activity_high"
                        name="activity"
                        value="2"
                      />
                      <label for="activity_high">High</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="btn-group" style="justify-content: space-between">
              <button class="btn btn-secondary" onclick="goToStep(1)">
                <i class="fas fa-arrow-left"></i>
                Back to Scan
              </button>
              <button class="btn btn-success btn-lg" onclick="analyzeRisk()">
                <i class="fas fa-chart-line"></i>
                Generate Risk Report
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- STEP 3: Results -->
      <div id="step3" class="step-content">
        <div class="results-container">
          <div class="results-header">
            <h2>Complete Risk Assessment Report</h2>
          </div>
          <div class="results-body">
            <div id="riskResultsContainer"></div>
            <div
              class="btn-group"
              style="justify-content: center; margin-top: 32px"
            >
              <button class="btn btn-secondary" onclick="goToStep(2)">
                <i class="fas fa-arrow-left"></i>
                Modify Profile
              </button>
              <button class="btn btn-primary" onclick="resetAssessment()">
                <i class="fas fa-redo"></i>
                New Assessment
              </button>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Loading Overlay -->
    <div id="loading">
      <div class="loader-wrapper">
        <div class="loader-ring"></div>
        <div style="text-align: center">
          <p class="loader-text" id="loadingText">Analyzing scan...</p>
          <p class="loader-subtext">VGG16 neural network processing</p>
        </div>
      </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
      let base_data = "";
      let scanResult = "";
      const stepsLabels = [
        "Step 1/3: Upload CT Scan Image",
        "Step 2/3: Health Profile",
        "Step 3/3: Risk Assessment",
      ];

      function updateNavigation(step) {
        document.querySelectorAll(".nav-item").forEach((item, index) => {
          item.classList.remove("active", "completed");
          if (index + 1 < step) {
            item.classList.add("completed");
          } else if (index + 1 === step) {
            item.classList.add("active");
          }
        });
      }

      function goToStep(step) {
        document
          .querySelectorAll(".step-content")
          .forEach((el) => el.classList.remove("active"));
        document.getElementById("step" + step).classList.add("active");
        document.getElementById("stepLabel").textContent =
          stepsLabels[step - 1];
        updateNavigation(step);
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      function predictImage() {
        if (!base_data) {
          alert("Please upload an image first!");
          return;
        }

        const btn = document.getElementById("predictImageBtn");
        const btnText = document.getElementById("analyzeBtnText");
        btn.classList.add("loading");

        $("#loading").addClass("show");
        $("#loadingText").text("Analyzing scan...");

        $.ajax({
          url: "/predict",
          type: "POST",
          contentType: "application/json",
          data: JSON.stringify({ image: base_data }),
          success: function (response) {
            $("#loading").removeClass("show");
            btn.classList.remove("loading");

            scanResult = response[0].image.toLowerCase();
            const confidence = response[0].confidence || 0.94;
            const confidencePercent = Math.round(confidence * 100);
            const resultBox = $("#imageResultContainer");

            if (scanResult === "tumor") {
              resultBox.html(`
                            <div class="diagnosis-result">
                                <div class="diagnosis-header tumor">
                                    <div class="diagnosis-icon-wrapper">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </div>
                                    <div class="diagnosis-badge">
                                        <i class="fas fa-radiation"></i>
                                        TUMOR DETECTED
                                    </div>
                                    <p class="diagnosis-subtitle">Abnormality identified in renal CT scan</p>
                                </div>
                                <div class="diagnosis-body">
                                    <div class="confidence-row">
                                        <div class="confidence-card">
                                            <p class="confidence-label">Confidence</p>
                                            <p class="confidence-value tumor">${confidencePercent}%</p>
                                        </div>
                                        <div class="confidence-card">
                                            <p class="confidence-label">Classification</p>
                                            <p class="confidence-value" style="font-size: 1.25rem; color: var(--slate-800);">Renal Mass</p>
                                        </div>
                                    </div>
                                    <div class="info-box">
                                        <i class="fas fa-stethoscope"></i>
                                        <span class="info-box-text">Complete the health profile for comprehensive clinical risk assessment using XGBoost model.</span>
                                    </div>
                                </div>
                            </div>
                        `);
            } else {
              resultBox.html(`
                            <div class="diagnosis-result">
                                <div class="diagnosis-header normal">
                                    <div class="diagnosis-icon-wrapper">
                                        <i class="fas fa-check-circle"></i>
                                    </div>
                                    <div class="diagnosis-badge">
                                        <i class="fas fa-shield-alt"></i>
                                        NORMAL
                                    </div>
                                    <p class="diagnosis-subtitle">No abnormalities detected</p>
                                </div>
                                <div class="diagnosis-body">
                                    <div class="confidence-row">
                                        <div class="confidence-card">
                                            <p class="confidence-label">Confidence</p>
                                            <p class="confidence-value normal">${confidencePercent}%</p>
                                        </div>
                                        <div class="confidence-card">
                                            <p class="confidence-label">Classification</p>
                                            <p class="confidence-value" style="font-size: 1.25rem; color: var(--slate-800);">Healthy</p>
                                        </div>
                                    </div>
                                    <div class="info-box">
                                        <i class="fas fa-info-circle"></i>
                                        <span class="info-box-text">Optionally complete the health profile to assess your overall kidney health risk factors.</span>
                                    </div>
                                </div>
                            </div>
                        `);
            }

            $("#predictImageBtn").hide();
            $("#proceedToQuestionnaire").show().prop("disabled", false);
          },
          error: function (xhr) {
            $("#loading").removeClass("show");
            btn.classList.remove("loading");

            $("#imageResultContainer").html(`
                        <div style="text-align: center; padding: 40px;">
                            <div style="width: 72px; height: 72px; background: rgba(239, 68, 68, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px;">
                                <i class="fas fa-times" style="font-size: 2rem; color: var(--red-500);"></i>
                            </div>
                            <p style="font-weight: 600; color: var(--red-500); margin-bottom: 8px;">Analysis Failed</p>
                            <p style="font-size: 0.875rem; color: var(--slate-500);">Please try again with a different image.</p>
                        </div>
                    `);
          },
        });
      }

      function collectFormData() {
        const data = {
          ct_result: scanResult,
          hematuria: parseInt($('input[name="hematuria"]:checked').val()),
          flank_pain: parseInt($('input[name="flank_pain"]:checked').val()),
          lower_back_pain: parseInt(
            $('input[name="lower_back_pain"]:checked').val(),
          ),
          fever: parseInt($('input[name="fever"]:checked').val()),
          appetite_loss: parseInt(
            $('input[name="appetite_loss"]:checked').val(),
          ),
          weight_loss: parseInt($('input[name="weight_loss"]:checked').val()),
          fatigue: parseInt($('input[name="fatigue"]:checked').val()),
          anemia: parseInt($('input[name="anemia"]:checked').val()),
          hypertension: parseInt($('input[name="hypertension"]:checked').val()),
          diabetes: parseInt($('input[name="diabetes"]:checked').val()),
          ckd: parseInt($('input[name="ckd"]:checked').val()),
          fh_kidney_tumor: parseInt(
            $('input[name="fh_kidney_tumor"]:checked').val(),
          ),
          fh_hypertension: parseInt(
            $('input[name="fh_hypertension"]:checked').val(),
          ),
          smoking: parseInt($('input[name="smoking"]:checked').val()),
          alcohol: parseInt($('input[name="alcohol"]:checked').val()),
          height: parseFloat($("#height").val()) || 170,
          weight: parseFloat($("#weight").val()) || 70,
          chemical_exposure: parseInt(
            $('input[name="chemical_exposure"]:checked').val(),
          ),
          activity_level: parseInt($('input[name="activity"]:checked').val()),
        };
        return data;
      }

      function analyzeRisk() {
        const formData = collectFormData();
        $("#loading").addClass("show");
        $("#loadingText").text("Processing clinical data...");

        $.ajax({
          url: "/analyze_risk",
          type: "POST",
          contentType: "application/json",
          data: JSON.stringify(formData),
          success: function (response) {
            $("#loading").removeClass("show");
            displayRiskResults(response);
            goToStep(3);
          },
          error: function (xhr) {
            $("#loading").removeClass("show");
            alert("Error analyzing risk profile");
            console.error(xhr.responseText);
          },
        });
      }

      function getRiskLevel(prob) {
        if (prob >= 0.6) return "high";
        if (prob >= 0.35) return "medium";
        return "low";
      }

      function createGauge(value) {
        const circumference = 2 * Math.PI * 80;
        const offset = circumference - (value / 100) * circumference;
        const level = value >= 60 ? "high" : value >= 35 ? "medium" : "low";
        const levelText =
          value >= 60 ? "High Risk" : value >= 35 ? "Moderate" : "Low Risk";

        return `
                <div class="gauge-container">
                    <p class="gauge-title">
                        <i class="fas fa-chart-pie"></i>
                        Clinical Risk Score (XGBoost)
                    </p>
                    <div class="gauge-wrapper">
                        <div class="gauge">
                            <svg width="200" height="200" viewBox="0 0 200 200">
                                <circle class="gauge-bg" cx="100" cy="100" r="80"/>
                                <circle class="gauge-fill ${level}" cx="100" cy="100" r="80" 
                                    stroke-dasharray="${circumference}" 
                                    stroke-dashoffset="${offset}"/>
                            </svg>
                            <div class="gauge-glow"></div>
                            <div class="gauge-text">
                                <span class="gauge-value">${value}%</span>
                                <span class="gauge-label">${levelText}</span>
                            </div>
                        </div>
                    </div>
                    <div class="gauge-legend">
                        <div class="gauge-legend-item">
                            <span class="gauge-legend-dot low"></span>
                            <span>&lt;35%</span>
                        </div>
                        <div class="gauge-legend-item">
                            <span class="gauge-legend-dot medium"></span>
                            <span>35-60%</span>
                        </div>
                        <div class="gauge-legend-item">
                            <span class="gauge-legend-dot high"></span>
                            <span>&gt;60%</span>
                        </div>
                    </div>
                </div>
            `;
      }

      function displayRiskResults(data) {
        const container = $("#riskResultsContainer");
        let html = "";

        // Calculate risk score
        let riskScore = 0;
        if (data.risk_factors) {
          const values = Object.values(data.risk_factors).filter(
            (v) => v > 0.2,
          );
          if (values.length > 0) {
            riskScore = Math.round(
              (values.reduce((a, b) => a + b, 0) / values.length) * 100,
            );
          }
        }

        const isTumor = data.ct_result === "tumor";

        html += `
                <div class="results-top-grid">
                    <div class="diagnosis-result">
                        <div class="diagnosis-header ${isTumor ? "tumor" : "normal"}">
                            <div class="diagnosis-icon-wrapper">
                                <i class="fas fa-${isTumor ? "exclamation-triangle" : "check-circle"}"></i>
                            </div>
                            <div class="diagnosis-badge">
                                ${isTumor ? "TUMOR DETECTED" : "SCAN NORMAL"}
                            </div>
                            <p class="diagnosis-subtitle">VGG16 Deep Learning Model</p>
                        </div>
                        <div class="diagnosis-body">
                            <p style="font-size: 0.875rem; color: var(--slate-500); padding: 20px; text-align: center;">
                                ${
                                  isTumor
                                    ? "Potential renal mass identified. Further clinical evaluation recommended."
                                    : "No abnormalities detected in the kidney CT scan."
                                }
                            </p>
                        </div>
                    </div>
                    ${createGauge(riskScore)}
                </div>
            `;

        // Risk factors grid
        html += `<div class="results-grid">`;

        if (data.risk_factors && Object.keys(data.risk_factors).length > 0) {
          html += `
                    <div class="result-card">
                        <h5 class="result-card-title">
                            <i class="fas fa-exclamation-circle"></i>
                            Identified Risk Factors
                        </h5>
                `;
          for (const [factor, prob] of Object.entries(data.risk_factors)) {
            if (prob > 0.2) {
              const percentage = (prob * 100).toFixed(0);
              const level = getRiskLevel(prob);
              const formattedFactor = factor
                .replace(/_/g, " ")
                .replace(/\b\w/g, (l) => l.toUpperCase());
              html += `
                            <div class="risk-item">
                                <span class="risk-label">${formattedFactor}</span>
                                <span class="risk-badge ${level}">${percentage}%</span>
                            </div>
                        `;
            }
          }
          html += `</div>`;
        }

        if (
          data.associated_conditions &&
          Object.keys(data.associated_conditions).length > 0
        ) {
          html += `
                    <div class="result-card">
                        <h5 class="result-card-title">
                            <i class="fas fa-notes-medical"></i>
                            Associated Conditions
                        </h5>
                `;
          for (const [condition, prob] of Object.entries(
            data.associated_conditions,
          )) {
            if (prob > 0.2) {
              const percentage = (prob * 100).toFixed(0);
              const level = getRiskLevel(prob);
              const formattedCondition = condition
                .replace(/_/g, " ")
                .replace(/\b\w/g, (l) => l.toUpperCase());
              html += `
                            <div class="risk-item">
                                <span class="risk-label">${formattedCondition}</span>
                                <span class="risk-badge ${level}">${percentage}%</span>
                            </div>
                        `;
            }
          }
          html += `</div>`;
        }

        html += `</div>`;

        html += `
                <div class="info-box" style="margin-top: 24px;">
                    <i class="fas fa-info-circle"></i>
                    <span class="info-box-text"><strong>Medical Disclaimer:</strong> This AI-powered assessment is for informational purposes only and should not replace professional medical advice. Please consult with a qualified healthcare provider for proper diagnosis and treatment.</span>
                </div>
            `;

        container.html(html);
      }

      function resetAssessment() {
        base_data = "";
        scanResult = "";
        document.getElementById("fileinput").value = "";
        document.getElementById("photo").classList.remove("show");
        document.getElementById("placeholderContent").style.display = "flex";
        document.getElementById("uploadArea").classList.remove("has-image");
        document.getElementById("predictImageBtn").disabled = true;
        document.getElementById("predictImageBtn").style.display =
          "inline-flex";

        $("#proceedToQuestionnaire").hide().prop("disabled", true);

        document.getElementById("imageResultContainer").innerHTML = `
                <div class="result-icon">
                    <i class="fas fa-microscope"></i>
                </div>
                <p class="result-text">Upload a CT scan image and click "Analyze" to get AI-powered diagnosis</p>
            `;
        document.getElementById("imageResultContainer").className =
          "result-placeholder";

        document.querySelectorAll("input[type='radio']").forEach((input) => {
          input.checked = input.defaultChecked;
        });
        document.querySelectorAll("input[type='number']").forEach((input) => {
          input.value = "";
        });

        goToStep(1);
      }

      $(document).ready(function () {
        // File upload handler
        $("#fileinput").change(function () {
          if (this.files && this.files[0]) {
            const reader = new FileReader();
            reader.onload = function (e) {
              const img = new Image();
              img.crossOrigin = "Anonymous";
              img.onload = function () {
                const canvas = document.createElement("canvas");
                const ctx = canvas.getContext("2d");
                canvas.height = this.height;
                canvas.width = this.width;
                ctx.drawImage(this, 0, 0);
                base_data = canvas
                  .toDataURL("image/jpeg", 1.0)
                  .replace(/^data:image.+;base64,/, "");
                $("#photo").attr("src", e.target.result).addClass("show");
                $("#placeholderContent").hide();
                $("#uploadArea").addClass("has-image");
                $("#predictImageBtn").prop("disabled", false);
                $("#proceedToQuestionnaire").hide().prop("disabled", true);
              };
              img.src = e.target.result;
            };
            reader.readAsDataURL(this.files[0]);
          }
        });

        // Predict button
        $("#predictImageBtn").click(function () {
          predictImage();
        });

        // Proceed to Questionnaire button
        $("#proceedToQuestionnaire").click(function () {
          goToStep(2);
        });

        // Drag and drop
        const uploadArea = document.getElementById("uploadArea");

        uploadArea.addEventListener("dragover", (e) => {
          e.preventDefault();
          uploadArea.classList.add("dragover");
        });

        uploadArea.addEventListener("dragleave", (e) => {
          e.preventDefault();
          uploadArea.classList.remove("dragover");
        });

        uploadArea.addEventListener("drop", (e) => {
          e.preventDefault();
          uploadArea.classList.remove("dragover");
          if (e.dataTransfer.files.length) {
            document.getElementById("fileinput").files = e.dataTransfer.files;
            $("#fileinput").trigger("change");
          }
        });
      });
    </script>
  </body>
</html>
